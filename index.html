<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NBA Career Journey Map</title>
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Source+Sans+3:wght@300;400;600;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary: #1d428a;
            --secondary: #c8102e;
            --gold: #fdb927;
            --dark: #0a0a0a;
            --light: #f8f9fa;
            --gray: #6c757d;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Source Sans 3', sans-serif;
            background: var(--dark);
            color: var(--light);
            min-height: 100vh;
        }
        
        /* Header */
        header {
            background: linear-gradient(135deg, var(--primary) 0%, #0d2240 100%);
            padding: 1.5rem 2rem;
            border-bottom: 4px solid var(--secondary);
        }
        
        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 1rem;
        }
        
        h1 {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 2.5rem;
            letter-spacing: 3px;
            color: var(--light);
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        h1 span {
            color: var(--gold);
        }
        
        /* Search Container */
        .search-container {
            position: relative;
            width: 100%;
            max-width: 400px;
        }
        
        #searchInput {
            width: 100%;
            padding: 0.8rem 1.2rem;
            font-size: 1rem;
            border: none;
            border-radius: 50px;
            background: rgba(255,255,255,0.95);
            color: var(--dark);
            outline: none;
            transition: box-shadow 0.3s ease;
        }
        
        #searchInput:focus {
            box-shadow: 0 0 0 3px var(--gold);
        }
        
        #searchInput::placeholder {
            color: var(--gray);
        }
        
        #suggestions {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border-radius: 0 0 12px 12px;
            box-shadow: 0 8px 24px rgba(0,0,0,0.3);
            max-height: 300px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
        }
        
        #suggestions.active {
            display: block;
        }
        
        .suggestion-item {
            padding: 0.8rem 1.2rem;
            cursor: pointer;
            color: var(--dark);
            border-bottom: 1px solid #eee;
            transition: background 0.2s;
        }
        
        .suggestion-item:hover {
            background: var(--gold);
        }
        
        .suggestion-item:last-child {
            border-bottom: none;
            border-radius: 0 0 12px 12px;
        }
        
        /* Main Layout */
        .main-container {
            display: grid;
            grid-template-columns: 350px 1fr;
            height: calc(100vh - 100px);
        }
        
        @media (max-width: 900px) {
            .main-container {
                grid-template-columns: 1fr;
                height: auto;
            }
        }
        
        /* Sidebar */
        .sidebar {
            background: linear-gradient(180deg, #1a1a1a 0%, #0d0d0d 100%);
            padding: 1.5rem;
            overflow-y: auto;
            border-right: 1px solid #333;
        }
        
        .player-info {
            display: none;
        }
        
        .player-info.active {
            display: block;
        }
        
        .player-name {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 2rem;
            letter-spacing: 2px;
            color: var(--gold);
            margin-bottom: 0.5rem;
        }
        
        .player-meta {
            color: var(--gray);
            font-size: 0.9rem;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid #333;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
            margin-bottom: 1.5rem;
        }
        
        .stat-box {
            background: rgba(255,255,255,0.05);
            padding: 1rem;
            border-radius: 8px;
            text-align: center;
            border: 1px solid #333;
        }
        
        .stat-value {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 1.8rem;
            color: var(--gold);
        }
        
        .stat-label {
            font-size: 0.75rem;
            color: var(--gray);
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .career-timeline {
            margin-top: 1.5rem;
        }
        
        .timeline-title {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 1.2rem;
            letter-spacing: 1px;
            color: var(--light);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .timeline-title::before {
            content: '';
            width: 4px;
            height: 20px;
            background: var(--secondary);
        }
        
        .timeline-item {
            display: flex;
            gap: 1rem;
            margin-bottom: 0;
            position: relative;
            padding-left: 1.5rem;
        }
        
        .timeline-item::before {
            content: '';
            position: absolute;
            left: 0;
            top: 8px;
            width: 10px;
            height: 10px;
            background: var(--secondary);
            border-radius: 50%;
            border: 2px solid var(--dark);
        }
        
        .timeline-item::after {
            content: '';
            position: absolute;
            left: 4px;
            top: 18px;
            width: 2px;
            height: calc(100% + 8px);
            background: #333;
        }
        
        .timeline-item:last-child::after {
            display: none;
        }
        
        .timeline-item:first-child::before {
            background: var(--gold);
        }
        
        .timeline-content {
            flex: 1;
            padding-bottom: 1.5rem;
        }
        
        .timeline-years {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 1rem;
            color: var(--gold);
            letter-spacing: 1px;
        }
        
        .timeline-team {
            font-weight: 600;
            color: var(--light);
            margin: 0.25rem 0;
        }
        
        .timeline-location {
            font-size: 0.85rem;
            color: var(--gray);
        }
        
        .timeline-location .flag {
            margin-right: 0.3rem;
        }
        
        /* Welcome Message */
        .welcome-message {
            text-align: center;
            padding: 3rem 1rem;
            color: var(--gray);
        }
        
        .welcome-message h2 {
            font-family: 'Bebas Neue', sans-serif;
            font-size: 1.5rem;
            color: var(--light);
            margin-bottom: 1rem;
        }
        
        .welcome-message p {
            font-size: 0.9rem;
            line-height: 1.6;
        }
        
        /* Map */
        #map {
            width: 100%;
            height: 100%;
            min-height: 500px;
            background: #1a1a2e;
        }
        
        /* Custom Map Markers */
        .custom-marker {
            background: var(--secondary);
            border: 3px solid white;
            border-radius: 50%;
            box-shadow: 0 2px 8px rgba(0,0,0,0.4);
        }
        
        .custom-marker.start {
            background: var(--gold);
        }
        
        .custom-marker.end {
            background: var(--primary);
        }
        
        /* Map Popup */
        .leaflet-popup-content-wrapper {
            background: var(--dark);
            color: var(--light);
            border-radius: 8px;
            border: 2px solid var(--secondary);
        }
        
        .leaflet-popup-tip {
            background: var(--dark);
        }
        
        .popup-content {
            padding: 0.5rem;
        }
        
        .popup-stop {
            font-family: 'Bebas Neue', sans-serif;
            color: var(--gold);
            font-size: 0.9rem;
        }
        
        .popup-team {
            font-weight: 600;
            margin: 0.25rem 0;
        }
        
        .popup-location {
            font-size: 0.85rem;
            color: var(--gray);
        }
        
        .popup-years {
            font-size: 0.85rem;
            color: var(--secondary);
            margin-top: 0.25rem;
        }
        
        /* Footer stats */
        .footer-stats {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0,0,0,0.9);
            padding: 0.5rem 2rem;
            font-size: 0.8rem;
            color: var(--gray);
            border-top: 1px solid #333;
            display: flex;
            justify-content: center;
            gap: 2rem;
        }
        
        .footer-stats span {
            color: var(--gold);
        }
    </style>
</head>
<body>
    <header>
        <div class="header-content">
            <h1>NBA <span>CAREER</span> JOURNEY</h1>
            <div class="search-container">
                <input type="text" id="searchInput" placeholder="Search for a player..." autocomplete="off">
                <div id="suggestions"></div>
            </div>
        </div>
    </header>
    
    <div class="main-container">
        <aside class="sidebar">
            <div class="welcome-message" id="welcomeMessage">
                <h2>Explore Player Journeys</h2>
                <p>Search for any NBA player to see their career trajectory mapped across the globe.</p>
                <p style="margin-top: 1rem;">From their first professional stop to their last, trace the path of basketball legends.</p>
            </div>
            
            <div class="player-info" id="playerInfo">
                <h2 class="player-name" id="playerName"></h2>
                <p class="player-meta" id="playerMeta"></p>
                
                <div class="stats-grid">
                    <div class="stat-box">
                        <div class="stat-value" id="statTeams">-</div>
                        <div class="stat-label">Teams</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value" id="statCountries">-</div>
                        <div class="stat-label">Countries</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value" id="statYears">-</div>
                        <div class="stat-label">Years Active</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value" id="statStops">-</div>
                        <div class="stat-label">Career Stops</div>
                    </div>
                </div>
                
                <div class="career-timeline">
                    <h3 class="timeline-title">Career Timeline</h3>
                    <div id="timeline"></div>
                </div>
            </div>
        </aside>
        
        <main>
            <div id="map"></div>
        </main>
    </div>
    
    <div class="footer-stats">
        <div>Players: <span id="totalPlayers">-</span></div>
        <div>Career Entries: <span id="totalCareers">-</span></div>
        <div>Coverage: <span>96.5%</span></div>
    </div>
    
    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <script>
        // City coordinates database - comprehensive list
        const CITY_COORDS = {
            // NBA Cities - USA
            "New York|New York|USA": [40.7128, -74.0060],
            "Brooklyn|New York|USA": [40.6782, -73.9442],
            "Los Angeles|California|USA": [34.0522, -118.2437],
            "Chicago|Illinois|USA": [41.8781, -87.6298],
            "Houston|Texas|USA": [29.7604, -95.3698],
            "Phoenix|Arizona|USA": [33.4484, -112.0740],
            "Philadelphia|Pennsylvania|USA": [39.9526, -75.1652],
            "San Antonio|Texas|USA": [29.4241, -98.4936],
            "San Diego|California|USA": [32.7157, -117.1611],
            "Dallas|Texas|USA": [32.7767, -96.7970],
            "Austin|Texas|USA": [30.2672, -97.7431],
            "Fort Worth|Texas|USA": [32.7555, -97.3308],
            "Charlotte|North Carolina|USA": [35.2271, -80.8431],
            "San Francisco|California|USA": [37.7749, -122.4194],
            "Indianapolis|Indiana|USA": [39.7684, -86.1581],
            "Seattle|Washington|USA": [47.6062, -122.3321],
            "Denver|Colorado|USA": [39.7392, -104.9903],
            "Boston|Massachusetts|USA": [42.3601, -71.0589],
            "Detroit|Michigan|USA": [42.3314, -83.0458],
            "Portland|Oregon|USA": [45.5152, -122.6784],
            "Portland|Maine|USA": [43.6591, -70.2568],
            "Memphis|Tennessee|USA": [35.1495, -90.0490],
            "Oklahoma City|Oklahoma|USA": [35.4676, -97.5164],
            "Milwaukee|Wisconsin|USA": [43.0389, -87.9065],
            "Atlanta|Georgia|USA": [33.7490, -84.3880],
            "Sacramento|California|USA": [38.5816, -121.4944],
            "Miami|Florida|USA": [25.7617, -80.1918],
            "Orlando|Florida|USA": [28.5383, -81.3792],
            "Minneapolis|Minnesota|USA": [44.9778, -93.2650],
            "Cleveland|Ohio|USA": [41.4993, -81.6944],
            "New Orleans|Louisiana|USA": [29.9511, -90.0715],
            "Salt Lake City|Utah|USA": [40.7608, -111.8910],
            "Washington|D.C.|USA": [38.9072, -77.0369],
            "Baltimore|Maryland|USA": [39.2904, -76.6122],
            "East Rutherford|New Jersey|USA": [40.8128, -74.0742],
            
            // G-League & Minor League USA
            "Sioux Falls|South Dakota|USA": [43.5446, -96.7311],
            "Boise|Idaho|USA": [43.6150, -116.2023],
            "Frisco|Texas|USA": [33.1507, -96.8236],
            "Edinburg|Texas|USA": [26.3017, -98.1633],
            "Stockton|California|USA": [37.9577, -121.2908],
            "Reno|Nevada|USA": [39.5296, -119.8138],
            "Fort Wayne|Indiana|USA": [41.0793, -85.1394],
            "Santa Cruz|California|USA": [36.9741, -122.0308],
            "Grand Rapids|Michigan|USA": [42.9634, -85.6681],
            "Erie|Pennsylvania|USA": [42.1292, -80.0851],
            "Canton|Ohio|USA": [40.7989, -81.3784],
            "Greensboro|North Carolina|USA": [36.0726, -79.7920],
            "Bakersfield|California|USA": [35.3733, -119.0187],
            "Tulsa|Oklahoma|USA": [36.1540, -95.9928],
            "Rapid City|South Dakota|USA": [44.0805, -103.2310],
            "Moline|Illinois|USA": [41.5067, -90.5151],
            "Rockford|Illinois|USA": [42.2711, -89.0940],
            "Yakima|Washington|USA": [46.6021, -120.5059],
            "Albany|New York|USA": [42.6526, -73.7562],
            "La Crosse|Wisconsin|USA": [43.8014, -91.2396],
            "Albuquerque|New Mexico|USA": [35.0844, -106.6504],
            "Las Vegas|Nevada|USA": [36.1699, -115.1398],
            "Henderson|Nevada|USA": [36.0395, -114.9817],
            "Scranton|Pennsylvania|USA": [41.4090, -75.6624],
            "Wilkes-Barre|Pennsylvania|USA": [41.2459, -75.8813],
            "Rochester|New York|USA": [43.1566, -77.6088],
            "Syracuse|New York|USA": [43.0481, -76.1474],
            "Buffalo|New York|USA": [42.8864, -78.8784],
            "Omaha|Nebraska|USA": [41.2565, -95.9345],
            "Wichita|Kansas|USA": [37.6872, -97.3301],
            "Kansas City|Missouri|USA": [39.0997, -94.5786],
            "St. Louis|Missouri|USA": [38.6270, -90.1994],
            "Louisville|Kentucky|USA": [38.2527, -85.7585],
            "Columbus|Ohio|USA": [39.9612, -82.9988],
            "Cincinnati|Ohio|USA": [39.1031, -84.5120],
            "Pittsburgh|Pennsylvania|USA": [40.4406, -79.9959],
            "Harrisburg|Pennsylvania|USA": [40.2732, -76.8867],
            "Allentown|Pennsylvania|USA": [40.6084, -75.4902],
            "Trenton|New Jersey|USA": [40.2171, -74.7429],
            "Hartford|Connecticut|USA": [41.7658, -72.6734],
            "Springfield|Massachusetts|USA": [42.1015, -72.5898],
            "Providence|Rhode Island|USA": [41.8240, -71.4128],
            "Birmingham|Alabama|USA": [33.5186, -86.8104],
            "Nashville|Tennessee|USA": [36.1627, -86.7816],
            "Kissimmee|Florida|USA": [28.2920, -81.4076],
            "Lakeland|Florida|USA": [28.0395, -81.9498],
            "Tampa|Florida|USA": [27.9506, -82.4572],
            "Jacksonville|Florida|USA": [30.3322, -81.6557],
            "Pensacola|Florida|USA": [30.4213, -87.2169],
            "Fayetteville|North Carolina|USA": [35.0527, -78.8784],
            "Roanoke|Virginia|USA": [37.2710, -79.9414],
            "Richmond|Virginia|USA": [37.5407, -77.4360],
            "Norfolk|Virginia|USA": [36.8508, -76.2859],
            "Charleston|South Carolina|USA": [32.7765, -79.9311],
            "Columbia|South Carolina|USA": [34.0007, -81.0348],
            "Savannah|Georgia|USA": [32.0809, -81.0912],
            "Huntsville|Alabama|USA": [34.7304, -86.5861],
            "Mobile|Alabama|USA": [30.6954, -88.0399],
            "Shreveport|Louisiana|USA": [32.5252, -93.7502],
            "Little Rock|Arkansas|USA": [34.7465, -92.2896],
            "Oklahoma City|Oklahoma|USA": [35.4676, -97.5164],
            "Des Moines|Iowa|USA": [41.5868, -93.6250],
            "Cedar Rapids|Iowa|USA": [41.9779, -91.6656],
            "Fargo|North Dakota|USA": [46.8772, -96.7898],
            "Bismarck|North Dakota|USA": [46.8083, -100.7837],
            "Billings|Montana|USA": [45.7833, -108.5007],
            "Great Falls|Montana|USA": [47.5053, -111.3008],
            "Anchorage|Alaska|USA": [61.2181, -149.9003],
            "Honolulu|Hawaii|USA": [21.3069, -157.8583],
            "White Plains|New York|USA": [41.0340, -73.7629],
            "Uniondale|New York|USA": [40.7001, -73.5926],
            "Newark|Delaware|USA": [39.6837, -75.7497],
            "Wilmington|Delaware|USA": [39.7391, -75.5398],
            
            // Canada
            "Toronto|Ontario|Canada": [43.6532, -79.3832],
            "Vancouver|British Columbia|Canada": [49.2827, -123.1207],
            "Montreal|Quebec|Canada": [45.5017, -73.5673],
            "Calgary|Alberta|Canada": [51.0447, -114.0719],
            "Edmonton|Alberta|Canada": [53.5461, -113.4938],
            "Winnipeg|Manitoba|Canada": [49.8951, -97.1384],
            "Ottawa|Ontario|Canada": [45.4215, -75.6972],
            "Mississauga|Ontario|Canada": [43.5890, -79.6441],
            "Halifax|Nova Scotia|Canada": [44.6488, -63.5752],
            "Saskatoon|Saskatchewan|Canada": [52.1332, -106.6700],
            
            // Spain
            "Madrid||Spain": [40.4168, -3.7038],
            "Barcelona||Spain": [41.3851, 2.1734],
            "Valencia||Spain": [39.4699, -0.3763],
            "Seville||Spain": [37.3891, -5.9845],
            "Sevilla||Spain": [37.3891, -5.9845],
            "Bilbao||Spain": [43.2630, -2.9350],
            "Malaga||Spain": [36.7213, -4.4214],
            "M치laga||Spain": [36.7213, -4.4214],
            "Zaragoza||Spain": [41.6488, -0.8891],
            "Murcia||Spain": [37.9922, -1.1307],
            "Vitoria-Gasteiz||Spain": [42.8467, -2.6716],
            "Granada||Spain": [37.1773, -3.5986],
            "Badalona||Spain": [41.4500, 2.2475],
            "San Sebasti치n||Spain": [43.3183, -1.9812],
            "Girona||Spain": [41.9794, 2.8214],
            "Manresa||Spain": [41.7251, 1.8265],
            "Tenerife||Spain": [28.4636, -16.2518],
            "Las Palmas||Spain": [28.1235, -15.4363],
            "Andorra||Spain": [42.5063, 1.5218],
            "Lugo||Spain": [43.0097, -7.5567],
            "Ourense||Spain": [42.3364, -7.8637],
            "Fuenlabrada||Spain": [40.2839, -3.7945],
            "C치ceres||Spain": [39.4753, -6.3724],
            "Le칩n||Spain": [42.5987, -5.5671],
            "Burgos||Spain": [42.3439, -3.6969],
            "Valladolid||Spain": [41.6523, -4.7245],
            
            // Italy
            "Rome||Italy": [41.9028, 12.4964],
            "Roma||Italy": [41.9028, 12.4964],
            "Milan||Italy": [45.4642, 9.1900],
            "Milano||Italy": [45.4642, 9.1900],
            "Naples||Italy": [40.8518, 14.2681],
            "Napoli||Italy": [40.8518, 14.2681],
            "Turin||Italy": [45.0703, 7.6869],
            "Torino||Italy": [45.0703, 7.6869],
            "Bologna||Italy": [44.4949, 11.3426],
            "Florence||Italy": [43.7696, 11.2558],
            "Venice||Italy": [45.4408, 12.3155],
            "Venezia||Italy": [45.4408, 12.3155],
            "Treviso||Italy": [45.6669, 12.2430],
            "Siena||Italy": [43.3188, 11.3308],
            "Pesaro||Italy": [43.9098, 12.9131],
            "Varese||Italy": [45.8206, 8.8257],
            "Trieste||Italy": [45.6495, 13.7768],
            "Cant칯||Italy": [45.7390, 9.1322],
            "Udine||Italy": [46.0711, 13.2346],
            "Reggio Emilia||Italy": [44.6989, 10.6297],
            "Reggio Calabria||Italy": [38.1112, 15.6470],
            "Livorno||Italy": [43.5485, 10.3106],
            "Pistoia||Italy": [43.9303, 10.9078],
            "Cremona||Italy": [45.1333, 10.0333],
            "Brescia||Italy": [45.5416, 10.2118],
            "Sassari||Italy": [40.7259, 8.5556],
            "Brindisi||Italy": [40.6327, 17.9419],
            "Avellino||Italy": [40.9146, 14.7906],
            "Caserta||Italy": [41.0742, 14.3320],
            "Rimini||Italy": [44.0678, 12.5695],
            
            // Greece
            "Athens||Greece": [37.9838, 23.7275],
            "Piraeus||Greece": [37.9475, 23.6412],
            "Thessaloniki||Greece": [40.6401, 22.9444],
            "Patras||Greece": [38.2466, 21.7346],
            "Larissa||Greece": [39.6390, 22.4191],
            "Heraklion||Greece": [35.3387, 25.1442],
            "Rhodes||Greece": [36.4349, 28.2176],
            
            // Turkey
            "Istanbul||Turkey": [41.0082, 28.9784],
            "Ankara||Turkey": [39.9334, 32.8597],
            "Izmir||Turkey": [38.4237, 27.1428],
            "캻zmir||Turkey": [38.4237, 27.1428],
            "Bursa||Turkey": [40.1885, 29.0610],
            "Antalya||Turkey": [36.8969, 30.7133],
            "Gaziantep||Turkey": [37.0662, 37.3833],
            "Konya||Turkey": [37.8746, 32.4932],
            "Trabzon||Turkey": [41.0027, 39.7168],
            "Band캼rma||Turkey": [40.3520, 27.9768],
            
            // France
            "Paris||France": [48.8566, 2.3522],
            "Lyon||France": [45.7640, 4.8357],
            "Marseille||France": [43.2965, 5.3698],
            "Toulouse||France": [43.6047, 1.4442],
            "Nice||France": [43.7102, 7.2620],
            "Strasbourg||France": [48.5734, 7.7521],
            "Limoges||France": [45.8336, 1.2611],
            "Villeurbanne||France": [45.7676, 4.8798],
            "Nanterre||France": [48.8924, 2.2071],
            "Levallois-Perret||France": [48.8933, 2.2882],
            "Dijon||France": [47.3220, 5.0415],
            "Roanne||France": [46.0344, 4.0688],
            "Cholet||France": [47.0596, -0.8788],
            "Le Mans||France": [48.0061, 0.1996],
            "Nancy||France": [48.6921, 6.1844],
            "Pau||France": [43.2951, -0.3708],
            "Antibes||France": [43.5808, 7.1239],
            "Gravelines||France": [50.9867, 2.1283],
            "Bourg-en-Bresse||France": [46.2056, 5.2254],
            
            // Germany
            "Berlin||Germany": [52.5200, 13.4050],
            "Munich||Germany": [48.1351, 11.5820],
            "Frankfurt||Germany": [50.1109, 8.6821],
            "Hamburg||Germany": [53.5511, 9.9937],
            "Cologne||Germany": [50.9375, 6.9603],
            "K칬ln||Germany": [50.9375, 6.9603],
            "Bamberg||Germany": [49.8988, 10.9028],
            "Ulm||Germany": [48.4011, 9.9876],
            "Bonn||Germany": [50.7374, 7.0982],
            "Oldenburg||Germany": [53.1435, 8.2146],
            "Ludwigsburg||Germany": [48.8975, 9.1922],
            "Bayreuth||Germany": [49.9456, 11.5713],
            "Braunschweig||Germany": [52.2689, 10.5268],
            
            // Russia
            "Moscow||Russia": [55.7558, 37.6173],
            "Saint Petersburg||Russia": [59.9311, 30.3609],
            "Kazan||Russia": [55.7887, 49.1221],
            "Krasnodar||Russia": [45.0355, 38.9753],
            "Khimki||Russia": [55.8970, 37.4297],
            "Saratov||Russia": [51.5336, 46.0343],
            "Samara||Russia": [53.1959, 50.1002],
            "Krasnoyarsk||Russia": [56.0153, 92.8932],
            "Novosibirsk||Russia": [55.0084, 82.9357],
            "Perm||Russia": [58.0104, 56.2294],
            
            // Eastern Europe
            "Belgrade||Serbia": [44.7866, 20.4489],
            "Zagreb||Croatia": [45.8150, 15.9819],
            "Split||Croatia": [43.5081, 16.4402],
            "Ljubljana||Slovenia": [46.0569, 14.5058],
            "Podgorica||Montenegro": [42.4304, 19.2594],
            "Sofia||Bulgaria": [42.6977, 23.3219],
            "Bucharest||Romania": [44.4268, 26.1025],
            "Warsaw||Poland": [52.2297, 21.0122],
            "Gdynia||Poland": [54.5189, 18.5305],
            "Wroclaw||Poland": [51.1079, 17.0385],
            "Wroc켹aw||Poland": [51.1079, 17.0385],
            "Prague||Czech Republic": [50.0755, 14.4378],
            "Vienna||Austria": [48.2082, 16.3738],
            "Budapest||Hungary": [47.4979, 19.0402],
            "Bratislava||Slovakia": [48.1486, 17.1077],
            
            // Baltic States
            "Kaunas||Lithuania": [54.8985, 23.9036],
            "Vilnius||Lithuania": [54.6872, 25.2797],
            "Riga||Latvia": [56.9496, 24.1052],
            "Tallinn||Estonia": [59.4370, 24.7536],
            
            // Ukraine
            "Kyiv||Ukraine": [50.4501, 30.5234],
            "Kharkiv||Ukraine": [49.9935, 36.2304],
            "Odessa||Ukraine": [46.4825, 30.7233],
            "Dnipro||Ukraine": [48.4647, 35.0462],
            "Donetsk||Ukraine": [48.0159, 37.8028],
            "Mariupol||Ukraine": [47.0958, 37.5496],
            
            // Israel
            "Tel Aviv||Israel": [32.0853, 34.7818],
            "Jerusalem||Israel": [31.7683, 35.2137],
            "Haifa||Israel": [32.7940, 34.9896],
            "Holon||Israel": [32.0158, 34.7878],
            "Herzliya||Israel": [32.1663, 34.8463],
            "Rishon LeZion||Israel": [31.9500, 34.8000],
            "Ramat Gan||Israel": [32.0700, 34.8236],
            "Eilat||Israel": [29.5577, 34.9519],
            
            // Middle East
            "Beirut||Lebanon": [33.8938, 35.5018],
            "Dubai||UAE": [25.2048, 55.2708],
            "Riyadh||Saudi Arabia": [24.7136, 46.6753],
            "Jeddah||Saudi Arabia": [21.5433, 39.1728],
            "Kuwait City||Kuwait": [29.3759, 47.9774],
            "Doha||Qatar": [25.2854, 51.5310],
            "Manama||Bahrain": [26.2285, 50.5860],
            "Tehran||Iran": [35.6892, 51.3890],
            
            // China
            "Beijing||China": [39.9042, 116.4074],
            "Shanghai||China": [31.2304, 121.4737],
            "Guangzhou||China": [23.1291, 113.2644],
            "Dongguan||China": [23.0207, 113.7518],
            "Shenzhen||China": [22.5431, 114.0579],
            "Nanjing||China": [32.0603, 118.7969],
            "Hangzhou||China": [30.2741, 120.1551],
            "Chengdu||China": [30.5728, 104.0668],
            "Wuhan||China": [30.5928, 114.3055],
            "Tianjin||China": [39.3434, 117.3616],
            "Qingdao||China": [36.0671, 120.3826],
            
            // Japan
            "Tokyo||Japan": [35.6762, 139.6503],
            "Osaka||Japan": [34.6937, 135.5023],
            "Nagoya||Japan": [35.1815, 136.9066],
            "Yokohama||Japan": [35.4437, 139.6380],
            "Kyoto||Japan": [35.0116, 135.7681],
            "Fukuoka||Japan": [33.5904, 130.4017],
            "Sapporo||Japan": [43.0618, 141.3545],
            "Toyohashi||Japan": [34.7690, 137.3916],
            "Kariya||Japan": [34.9890, 137.0015],
            
            // South Korea
            "Seoul||South Korea": [37.5665, 126.9780],
            "Busan||South Korea": [35.1796, 129.0756],
            "Incheon||South Korea": [37.4563, 126.7052],
            "Daegu||South Korea": [35.8714, 128.6014],
            
            // Taiwan
            "Taipei||Taiwan": [25.0330, 121.5654],
            "Kaohsiung||Taiwan": [22.6273, 120.3014],
            "Taichung City||Taiwan": [24.1477, 120.6736],
            
            // Philippines
            "Manila||Philippines": [14.5995, 120.9842],
            "Quezon City||Philippines": [14.6760, 121.0437],
            
            // Australia
            "Sydney|New South Wales|Australia": [-33.8688, 151.2093],
            "Melbourne|Victoria|Australia": [-37.8136, 144.9631],
            "Brisbane|Queensland|Australia": [-27.4698, 153.0251],
            "Perth|Western Australia|Australia": [-31.9505, 115.8605],
            "Adelaide|South Australia|Australia": [-34.9285, 138.6007],
            "Cairns|Queensland|Australia": [-16.9186, 145.7781],
            "Hobart|Tasmania|Australia": [-42.8821, 147.3272],
            "Wollongong|New South Wales|Australia": [-34.4278, 150.8931],
            "Townsville|Queensland|Australia": [-19.2590, 146.8169],
            
            // New Zealand
            "Auckland||New Zealand": [-36.8509, 174.7645],
            "Wellington||New Zealand": [-41.2866, 174.7756],
            
            // Latin America
            "Mexico City||Mexico": [19.4326, -99.1332],
            "Guadalajara||Mexico": [20.6597, -103.3496],
            "Monterrey||Mexico": [25.6866, -100.3161],
            "Canc칰n||Mexico": [21.1619, -86.8515],
            "Tijuana||Mexico": [32.5149, -117.0382],
            "Culiac치n||Mexico": [24.8091, -107.3940],
            "S칚o Paulo||Brazil": [-23.5505, -46.6333],
            "Rio de Janeiro||Brazil": [-22.9068, -43.1729],
            "Buenos Aires||Argentina": [-34.6037, -58.3816],
            "C칩rdoba||Argentina": [-31.4201, -64.1888],
            "Mar del Plata||Argentina": [-38.0055, -57.5426],
            "Caracas||Venezuela": [10.4806, -66.9036],
            "Bogot치||Colombia": [4.7110, -74.0721],
            "Lima||Peru": [-12.0464, -77.0428],
            "Santiago||Chile": [-33.4489, -70.6693],
            "Montevideo||Uruguay": [-34.9011, -56.1645],
            
            // Puerto Rico
            "San Juan||Puerto Rico": [18.4655, -66.1057],
            "Bayam칩n||Puerto Rico": [18.3833, -66.1500],
            "Carolina||Puerto Rico": [18.3808, -65.9572],
            "Mayag칲ez||Puerto Rico": [18.2013, -67.1397],
            "Ponce||Puerto Rico": [18.0111, -66.6141],
            "Arecibo||Puerto Rico": [18.4725, -66.7156],
            "Guaynabo||Puerto Rico": [18.3833, -66.1000],
            "Caguas||Puerto Rico": [18.2388, -66.0377],
            "Humacao||Puerto Rico": [18.1497, -65.8197],
            "Fajardo||Puerto Rico": [18.3258, -65.6525],
            "Aguadilla||Puerto Rico": [18.4275, -67.1541],
            "Aguada||Puerto Rico": [18.3808, -67.1883],
            "San Germ치n||Puerto Rico": [18.0828, -67.0461],
            "Manat칤||Puerto Rico": [18.4297, -66.4867],
            "Aibonito||Puerto Rico": [18.1397, -66.2658],
            
            // Dominican Republic
            "Santo Domingo||Dominican Republic": [18.4861, -69.9312],
            "Santiago||Dominican Republic": [19.4500, -70.7000],
            "La Vega||Dominican Republic": [19.2167, -70.5333],
        };
        
        // Country fallback coordinates
        const COUNTRY_COORDS = {
            "USA": [39.8283, -98.5795],
            "Canada": [56.1304, -106.3468],
            "Spain": [40.4637, -3.7492],
            "Italy": [41.8719, 12.5674],
            "France": [46.2276, 2.2137],
            "Germany": [51.1657, 10.4515],
            "Greece": [39.0742, 21.8243],
            "Turkey": [38.9637, 35.2433],
            "Russia": [61.5240, 105.3188],
            "Serbia": [44.0165, 21.0059],
            "Croatia": [45.1000, 15.2000],
            "Slovenia": [46.1512, 14.9955],
            "Lithuania": [55.1694, 23.8813],
            "Latvia": [56.8796, 24.6032],
            "Estonia": [58.5953, 25.0136],
            "Israel": [31.0461, 34.8516],
            "China": [35.8617, 104.1954],
            "Japan": [36.2048, 138.2529],
            "South Korea": [35.9078, 127.7669],
            "Taiwan": [23.6978, 120.9605],
            "Philippines": [12.8797, 121.7740],
            "Australia": [-25.2744, 133.7751],
            "New Zealand": [-40.9006, 174.8860],
            "Puerto Rico": [18.2208, -66.5901],
            "Argentina": [-38.4161, -63.6167],
            "Brazil": [-14.2350, -51.9253],
            "Venezuela": [6.4238, -66.5897],
            "Mexico": [23.6345, -102.5528],
            "Poland": [51.9194, 19.1451],
            "Ukraine": [48.3794, 31.1656],
            "Belgium": [50.5039, 4.4699],
            "Netherlands": [52.1326, 5.2913],
            "Portugal": [39.3999, -8.2245],
            "Montenegro": [42.7087, 19.3744],
            "Bosnia": [43.9159, 17.6791],
            "Bulgaria": [42.7339, 25.4858],
            "Romania": [45.9432, 24.9668],
            "Hungary": [47.1625, 19.5033],
            "Czech Republic": [49.8175, 15.4730],
            "Austria": [47.5162, 14.5501],
            "Switzerland": [46.8182, 8.2275],
            "Sweden": [60.1282, 18.6435],
            "Finland": [61.9241, 25.7482],
            "Denmark": [56.2639, 9.5018],
            "Norway": [60.4720, 8.4689],
            "United Kingdom": [55.3781, -3.4360],
            "Ireland": [53.4129, -8.2439],
            "Cyprus": [35.1264, 33.4299],
            "Lebanon": [33.8547, 35.8623],
            "UAE": [23.4241, 53.8478],
            "Saudi Arabia": [23.8859, 45.0792],
            "Kuwait": [29.3117, 47.4818],
            "Qatar": [25.3548, 51.1839],
            "Bahrain": [26.0667, 50.5577],
            "Iran": [32.4279, 53.6880],
            "Dominican Republic": [18.7357, -70.1627],
            "Uruguay": [-32.5228, -55.7658],
            "Chile": [-35.6751, -71.5430],
            "Colombia": [4.5709, -74.2973],
            "Peru": [-9.1900, -75.0152],
            "Morocco": [31.7917, -7.0926],
            "Tunisia": [33.8869, 9.5375],
            "Egypt": [26.8206, 30.8025],
            "Nigeria": [9.0820, 8.6753],
            "South Africa": [-30.5595, 22.9375],
            "Senegal": [14.4974, -14.4524],
            "Ivory Coast": [7.5400, -5.5471],
            "Angola": [-11.2027, 17.8739],
            "Indonesia": [-0.7893, 113.9213],
            "Malaysia": [4.2105, 101.9758],
            "Singapore": [1.3521, 103.8198],
            "Thailand": [15.8700, 100.9925],
            "Vietnam": [14.0583, 108.2772],
            "India": [20.5937, 78.9629],
            "Georgia": [42.3154, 43.3569],
            "Kazakhstan": [48.0196, 66.9237],
            "Mongolia": [46.8625, 103.8467],
            "Kosovo": [42.6026, 20.9030],
            "Slovakia": [48.6690, 19.6990],
            "Iceland": [64.9631, -19.0208],
            "Libya": [26.3351, 17.2283],
            "Syria": [34.8021, 38.9968],
            "Jordan": [30.5852, 36.2384],
            "Iraq": [33.2232, 43.6793],
            "Nicaragua": [12.8654, -85.2072],
            "Honduras": [15.2000, -86.2419],
            "Bolivia": [-16.2902, -63.5887],
            "Ecuador": [-1.8312, -78.1834],
            "Luxembourg": [49.8153, 6.1296],
            "Monaco": [43.7384, 7.4246],
            "Hong Kong": [22.3193, 114.1694],
        };
        
        // Get coordinates for a location
        function getCoords(city, state, country) {
            if (!city) return null;
            
            // Try exact match first
            const key1 = `${city}|${state || ''}|${country || ''}`;
            if (CITY_COORDS[key1]) return CITY_COORDS[key1];
            
            // Try without state
            const key2 = `${city}||${country || ''}`;
            if (CITY_COORDS[key2]) return CITY_COORDS[key2];
            
            // Try country fallback with randomization
            if (country && COUNTRY_COORDS[country]) {
                const base = COUNTRY_COORDS[country];
                // Add deterministic offset based on city name to avoid stacking
                const hash = city.split('').reduce((a, b) => ((a << 5) - a) + b.charCodeAt(0), 0);
                const offsetLat = ((hash % 100) - 50) / 25;
                const offsetLng = (((hash >> 8) % 100) - 50) / 25;
                return [base[0] + offsetLat, base[1] + offsetLng];
            }
            
            return null;
        }
        
        // Country flag emoji mapping
        const FLAGS = {
            "USA": "游쥟릖", "Canada": "游뻟릖", "Spain": "游쀯릖", "Italy": "游쉻릖", "France": "游游",
            "Germany": "游뾇릖", "Greece": "游섫릖", "Turkey": "游좷릖", "Russia": "游游", "Serbia": "游游",
            "Croatia": "游쇓릖", "Slovenia": "游젏릖", "Lithuania": "游쐟릖", "Latvia": "游쐟릖", "Estonia": "游쀯릖",
            "Israel": "游쉻릖", "China": "游뻟릖", "Japan": "游游", "South Korea": "游썷릖", "Taiwan": "游좷릖",
            "Philippines": "游왫릖", "Australia": "游뷣릖", "New Zealand": "游游",
            "Puerto Rico": "游왫릖", "Argentina": "游뷣릖", "Brazil": "游游", "Venezuela": "游游",
            "Mexico": "游쓇릖", "Poland": "游왫릖", "Ukraine": "游쥟릖", "Belgium": "游游",
            "Netherlands": "游游", "Portugal": "游왫릖", "Montenegro": "游쓇릖", "Bosnia": "游游",
            "Bulgaria": "游游", "Romania": "游游", "Hungary": "游쇓릖", "Czech Republic": "游뻟릖",
            "Austria": "游뷣릖", "Switzerland": "游뻟릖", "Sweden": "游젏릖", "Finland": "游游",
            "Denmark": "游뾇릖", "Norway": "游游", "United Kingdom": "游섫릖", "Ireland": "游쉻릖",
            "Cyprus": "游뻟릖", "Lebanon": "游쐟릖", "UAE": "游뷣릖", "Saudi Arabia": "游젏릖",
            "Kuwait": "游썷릖", "Qatar": "游윓릖", "Bahrain": "游游", "Iran": "游쉻릖",
            "Dominican Republic": "游뾇릖", "Uruguay": "游쥟릖", "Chile": "游뻟릖", "Colombia": "游뻟릖",
            "Peru": "游왫릖", "Egypt": "游쀯릖", "Morocco": "游쓇릖", "Tunisia": "游좷릖",
            "Nigeria": "游游", "South Africa": "游游", "Senegal": "游젏릖", "Ivory Coast": "游뻟릖",
            "Angola": "游뷣릖", "Indonesia": "游쉻릖", "Malaysia": "游쓇릖", "Singapore": "游젏릖",
            "Thailand": "游좷릖", "Vietnam": "游游", "India": "游쉻릖", "Georgia": "游섫릖",
            "Kazakhstan": "游썷릖", "Mongolia": "游쓇릖", "Kosovo": "游쬃릖", "Slovakia": "游젏릖",
            "Iceland": "游쉻릖", "Libya": "游쐟릖", "Syria": "游젏릖", "Jordan": "游游",
            "Iraq": "游쉻릖", "Nicaragua": "游游", "Honduras": "游쇓릖", "Bolivia": "游游",
            "Ecuador": "游쀯릖", "Luxembourg": "游쐟릖", "Monaco": "游쓇릖", "Hong Kong": "游쇓릖",
            "Belarus": "游游", "Moldova": "游쓇릖", "Albania": "游뷣릖", "North Macedonia": "游쓇릖"
        };
        
        function getFlag(country) {
            return FLAGS[country] || '游깴';
        }
        
        // Initialize map
        let map;
        let markersLayer;
        let polylineLayer;
        
        function initMap() {
            map = L.map('map', {
                center: [39.8283, -98.5795],
                zoom: 4,
                zoomControl: true
            });
            
            // Dark theme tiles
            L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OSM</a> &copy; <a href="https://carto.com/attributions">CARTO</a>',
                subdomains: 'abcd',
                maxZoom: 19
            }).addTo(map);
            
            markersLayer = L.layerGroup().addTo(map);
            polylineLayer = L.layerGroup().addTo(map);
        }
        
        // Clear map
        function clearMap() {
            markersLayer.clearLayers();
            polylineLayer.clearLayers();
        }
        
        // Display player on map
        function displayPlayerOnMap(career) {
            clearMap();
            
            const points = [];
            const bounds = [];
            
            career.forEach((stop, index) => {
                const coords = getCoords(stop.city, stop.state, stop.country);
                if (coords) {
                    points.push({
                        coords: coords,
                        stop: stop,
                        index: index
                    });
                    bounds.push(coords);
                }
            });
            
            if (points.length === 0) return;
            
            // Draw polyline connecting all stops
            if (points.length > 1) {
                const latlngs = points.map(p => p.coords);
                L.polyline(latlngs, {
                    color: '#fdb927',
                    weight: 3,
                    opacity: 0.8,
                    dashArray: '10, 5'
                }).addTo(polylineLayer);
            }
            
            // Add markers
            points.forEach((point, i) => {
                const isFirst = i === 0;
                const isLast = i === points.length - 1;
                
                let markerClass = 'custom-marker';
                let size = 14;
                if (isFirst) {
                    markerClass += ' start';
                    size = 20;
                } else if (isLast) {
                    markerClass += ' end';
                    size = 20;
                }
                
                const icon = L.divIcon({
                    className: markerClass,
                    iconSize: [size, size],
                    iconAnchor: [size/2, size/2]
                });
                
                const marker = L.marker(point.coords, { icon: icon }).addTo(markersLayer);
                
                const stopLabel = isFirst ? '游 START' : (isLast ? '游끠 LATEST' : `STOP ${i + 1}`);
                const location = point.stop.state 
                    ? `${point.stop.city}, ${point.stop.state}`
                    : point.stop.city || 'Unknown';
                
                marker.bindPopup(`
                    <div class="popup-content">
                        <div class="popup-stop">${stopLabel}</div>
                        <div class="popup-team">${point.stop.team}</div>
                        <div class="popup-location">${getFlag(point.stop.country)} ${location}${point.stop.country ? ', ' + point.stop.country : ''}</div>
                        <div class="popup-years">${point.stop.years}</div>
                    </div>
                `, { closeButton: false });
            });
            
            // Fit bounds with padding
            if (bounds.length > 0) {
                map.fitBounds(bounds, { padding: [50, 50], maxZoom: 6 });
            }
        }
        
        // Data storage
        let playersList = [];
        let careersData = {};
        
        // Load data
        async function loadData() {
            try {
                // Load player list
                const playersResponse = await fetch('nba_players_list.csv');
                const playersText = await playersResponse.text();
                playersList = playersText.trim().split('\n').slice(1).map(line => {
                    const parts = line.split(',');
                    return parts[0]?.replace(/"/g, '').trim();
                }).filter(name => name);
                
                // Load careers data
                const careersResponse = await fetch('nba_players_careers_READY.json');
                const careersArray = await careersResponse.json();
                
                // Convert to lookup (field is 'player', not 'player_name')
                careersArray.forEach(p => {
                    careersData[p.player] = p;
                });
                
                // Update stats
                document.getElementById('totalPlayers').textContent = playersList.length.toLocaleString();
                let totalCareers = 0;
                Object.values(careersData).forEach(p => {
                    if (p.career_history) totalCareers += p.career_history.length;
                });
                document.getElementById('totalCareers').textContent = totalCareers.toLocaleString();
                
            } catch (error) {
                console.error('Error loading data:', error);
            }
        }
        
        // Search functionality
        const searchInput = document.getElementById('searchInput');
        const suggestions = document.getElementById('suggestions');
        
        searchInput.addEventListener('input', function() {
            const query = this.value.toLowerCase().trim();
            
            if (query.length < 2) {
                suggestions.classList.remove('active');
                return;
            }
            
            const matches = playersList.filter(name => 
                name.toLowerCase().includes(query)
            ).slice(0, 10);
            
            if (matches.length === 0) {
                suggestions.classList.remove('active');
                return;
            }
            
            suggestions.innerHTML = matches.map(name => 
                `<div class="suggestion-item" data-name="${name}">${name}</div>`
            ).join('');
            suggestions.classList.add('active');
        });
        
        suggestions.addEventListener('click', function(e) {
            if (e.target.classList.contains('suggestion-item')) {
                const name = e.target.dataset.name;
                searchInput.value = name;
                suggestions.classList.remove('active');
                displayPlayer(name);
            }
        });
        
        // Close suggestions on outside click
        document.addEventListener('click', function(e) {
            if (!searchInput.contains(e.target) && !suggestions.contains(e.target)) {
                suggestions.classList.remove('active');
            }
        });
        
        // Enter key
        searchInput.addEventListener('keydown', function(e) {
            if (e.key === 'Enter') {
                const firstSuggestion = suggestions.querySelector('.suggestion-item');
                if (firstSuggestion) {
                    const name = firstSuggestion.dataset.name;
                    searchInput.value = name;
                    suggestions.classList.remove('active');
                    displayPlayer(name);
                }
            }
        });
        
        // Display player info
        function displayPlayer(name) {
            const player = careersData[name];
            
            if (!player || !player.career_history || player.career_history.length === 0) {
                alert('No career data available for this player.');
                return;
            }
            
            const career = player.career_history;
            
            // Hide welcome, show player info
            document.getElementById('welcomeMessage').style.display = 'none';
            document.getElementById('playerInfo').classList.add('active');
            
            // Player name
            document.getElementById('playerName').textContent = name;
            
            // Meta info
            const firstYear = career[0].years.split('-')[0];
            const lastYear = career[career.length - 1].years.split('-')[1];
            document.getElementById('playerMeta').textContent = `${firstYear} - ${lastYear}`;
            
            // Stats
            const uniqueTeams = new Set(career.map(c => c.team)).size;
            const uniqueCountries = new Set(career.map(c => c.country).filter(c => c)).size;
            const yearsActive = parseInt(lastYear) - parseInt(firstYear);
            
            document.getElementById('statTeams').textContent = uniqueTeams;
            document.getElementById('statCountries').textContent = uniqueCountries || 1;
            document.getElementById('statYears').textContent = yearsActive > 0 ? yearsActive : 1;
            document.getElementById('statStops').textContent = career.length;
            
            // Timeline
            const timeline = document.getElementById('timeline');
            timeline.innerHTML = career.map(stop => {
                const location = stop.city 
                    ? (stop.state ? `${stop.city}, ${stop.state}` : stop.city)
                    : 'Unknown location';
                const flag = stop.country ? getFlag(stop.country) : '';
                const country = stop.country || '';
                
                return `
                    <div class="timeline-item">
                        <div class="timeline-content">
                            <div class="timeline-years">${stop.years}</div>
                            <div class="timeline-team">${stop.team}</div>
                            <div class="timeline-location">
                                <span class="flag">${flag}</span>${location}${country ? `, ${country}` : ''}
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
            
            // Update map
            displayPlayerOnMap(career);
        }
        
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            initMap();
            loadData();
        });
    </script>
</body>
</html>
